<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mo Bahi - Digital Books</title>
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    
    <!-- Google Fonts for better typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- YOUR ORIGINAL, BEAUTIFUL CSS - FULLY RESTORED -->
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --primary-color: #2563eb; --primary-dark: #1d4ed8; --primary-light: #3b82f6; --secondary-color: #64748b; --text-primary: #0f172a; --text-secondary: #64748b; --text-muted: #94a3b8; --background: #ffffff; --surface: #f8fafc; --surface-dark: #f1f5f9; --border: #e2e8f0; --border-light: #f1f5f9; --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); --radius: 16px; --radius-sm: 8px; --radius-lg: 24px; --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); --bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55); --ease-out-quart: cubic-bezier(0.165, 0.84, 0.44, 1); }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); color: var(--text-primary); line-height: 1.6; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; overflow-x: hidden; font-feature-settings: "cv05", "cv06", "cv11"; padding-top: 70px; padding-bottom: 90px; }
        .app-wrapper { max-width: 428px; margin: 0 auto; background: var(--background); min-height: 100vh; position: relative; box-shadow: var(--shadow-xl); transition: var(--transition); border-radius: 0; overflow: hidden; }
        @media (min-width: 768px) { body { padding: 24px; background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); } .app-wrapper { max-width: 768px; min-height: calc(100vh - 48px); border-radius: var(--radius-lg); } }
        @media (min-width: 1024px) { body { padding: 40px; } .app-wrapper { max-width: 1200px; display: flex; flex-direction: column; min-height: calc(100vh - 80px); border-radius: var(--radius-lg); } .desktop-layout { display: flex; flex: 1; border-radius: var(--radius-lg); overflow: hidden; } .sidebar { width: 300px; background: linear-gradient(180deg, var(--surface) 0%, var(--surface-dark) 100%); border-right: 1px solid var(--border); padding: 40px 32px; display: flex; flex-direction: column; gap: 40px; position: relative; } .main-content { flex: 1; display: flex; flex-direction: column; background: var(--background); } .content-area { flex: 1; padding: 40px; overflow-y: auto; scroll-behavior: smooth; } }
        @media (min-width: 1440px) { .app-wrapper { max-width: 1400px; } .sidebar { width: 320px; padding: 48px 40px; } .content-area { padding: 48px 56px; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } } @keyframes slideInRight { from { opacity: 0; transform: translateX(40px); } to { opacity: 1; transform: translateX(0); } } @keyframes scaleIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } } @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .fade-in { animation: fadeIn 0.8s var(--ease-out-quart); } .slide-in-right { animation: slideInRight 0.6s var(--ease-out-quart); } .scale-in { animation: scaleIn 0.5s var(--bounce); }
        .page-transition { opacity: 0; transform: translateX(20px); transition: var(--transition); } .page-transition.active { opacity: 1; transform: translateX(0); }
        .svg-icon { width: 20px; height: 20px; fill: currentColor; display: inline-block; vertical-align: middle; flex-shrink: 0; transition: var(--transition-fast); }
        header { position: fixed; top: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 428px; height: 70px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border-light); display: flex; align-items: center; padding: 0 24px; z-index: 100; transition: var(--transition); }
        @media (min-width: 768px) { header { max-width: 768px; position: relative; top: auto; left: auto; transform: none; border-radius: var(--radius-lg) var(--radius-lg) 0 0; height: 80px; } body { padding-top: 24px; } }
        @media (min-width: 1024px) { header { max-width: none; width: 100%; border-radius: 0; height: 90px; padding: 0 40px; background: var(--background) !important; position:relative !important; transform: none !important; left:auto !important; top:auto !important; border-bottom: 1px solid var(--border); } body { padding-top: 40px; } }
        .header-content { width: 100%; display: flex; align-items: center; }
        .back-btn { background: linear-gradient(135deg, var(--surface) 0%, var(--surface-dark) 100%); border: none; cursor: pointer; padding: 14px; margin-right: 20px; border-radius: 14px; color: var(--text-primary); display: flex; align-items: center; justify-content: center; transition: var(--transition); }
        .back-btn:hover { transform: translateX(-3px) scale(1.05); }
        .header-title { font-size: 24px; font-weight: 800; color: var(--text-primary); } @media (min-width: 1024px) { .header-title { font-size: 32px; } }
        .sidebar-nav { display: none; }
        @media (min-width: 1024px) { .sidebar-nav { display: flex; flex-direction: column; gap: 12px; } .sidebar-nav-item { display: flex; align-items: center; gap: 20px; padding: 20px 24px; border-radius: 16px; text-decoration: none; color: var(--text-secondary); font-weight: 600; font-size: 16px; transition: var(--transition); } .sidebar-nav-item:hover { background: rgba(37, 99, 235, 0.08); color: var(--primary-color); transform: translateX(6px); } .sidebar-nav-item.active { background: var(--primary-color); color: white; } }
        main { padding: 24px; background: var(--background); min-height: calc(100vh - 160px); }
        @media (min-width: 768px) { main { padding: 32px; } }
        @media (min-width: 1024px) { main { padding: 0; min-height: auto; } }
        nav { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 428px; height: 90px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); border-top: 1px solid var(--border-light); z-index: 100; transition: var(--transition); }
        @media (min-width: 768px) { nav { max-width: 768px; position: relative; bottom: auto; left: auto; transform: none; border-radius: 0 0 var(--radius-lg) var(--radius-lg); } body { padding-bottom: 24px; } }
        @media (min-width: 1024px) { nav { display: none; } body { padding-bottom: 40px; } }
        .nav-content { height: 100%; display: flex; align-items: center; justify-content: space-around; padding: 0 24px; }
        .nav-item { display: flex; flex-direction: column; align-items: center; text-decoration: none; color: var(--text-muted); font-size: 12px; font-weight: 600; padding: 12px 18px; border-radius: 18px; transition: var(--transition); }
        .nav-item.active { color: var(--primary-color); background: rgba(37, 99, 235, 0.1); transform: translateY(-3px) scale(1.05); }
        .slider-section { margin-bottom: 48px; }
        .swiper { border-radius: var(--radius); overflow: hidden; }
        .slider-slide { position: relative; height: 240px; background-size: cover; background-position: center; display: flex; align-items: flex-end; color: white; } @media (min-width: 768px) { .slider-slide { height: 360px; } } @media (min-width: 1024px) { .slider-slide { height: 450px; } }
        .slider-overlay { position: absolute; inset: 0; background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.8) 100%); }
        .slider-content { position: relative; z-index: 3; padding: 40px; } .slider-title { font-size: 28px; font-weight: 900; } .read-now-btn { background: var(--primary-color); color: white; border: none; padding: 16px 32px; border-radius: 14px; cursor: pointer; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; padding-bottom: 16px; border-bottom: 1px solid var(--border-light); } .section-title { font-size: 26px; font-weight: 900; }
        .categories-scroll { display: flex; gap: 24px; overflow-x: auto; scrollbar-width: none; } .categories-scroll::-webkit-scrollbar { display: none; } @media (min-width: 1024px) { .categories-scroll { display: grid; grid-template-columns: repeat(5, 1fr); gap: 40px; } }
        .category-item { flex-shrink: 0; text-align: center; text-decoration: none; } .category-icon { width: 90px; height: 90px; border-radius: 50%; background-size: cover; background-position: center; border: 3px solid var(--border); margin-bottom: 16px; } .category-name { font-size: 14px; font-weight: 700; }
        .books-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; } @media (min-width: 640px) { .books-grid { grid-template-columns: repeat(3, 1fr); } } @media (min-width: 1024px) { .books-grid { grid-template-columns: repeat(4, 1fr); } }
        .book-card { text-decoration: none; color: var(--text-primary); border-radius: var(--radius); background: var(--background); box-shadow: var(--shadow); cursor: pointer; position: relative; } .book-cover { width: 100%; aspect-ratio: 3/4; background-size: cover; background-position: center; } .book-info { padding: 24px; } .book-title { font-size: 16px; font-weight: 800; }
        .like-btn { position: absolute; top: 16px; right: 16px; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: none; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: var(--transition); color: var(--text-secondary); } .like-btn.liked { color: #ef4444; animation: pulse 0.5s; }
        .book-details { max-width: 800px; margin: 0 auto; } @media (min-width: 1024px) { .book-details { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; } } .book-hero { display: flex; flex-direction: column; align-items: center; gap: 32px; margin-bottom: 48px; } .book-cover-large { width: 220px; height: 330px; border-radius: var(--radius); background-size: cover; background-position: center; box-shadow: var(--shadow-xl); } .book-title-large { font-size: 36px; }
        .book-pricing { background: var(--surface); padding: 32px; border-radius: var(--radius); margin-bottom: 40px; } .pricing-row { display: flex; justify-content: space-between; margin-bottom: 16px; }
        .book-actions { display: flex; gap: 20px; } .action-btn { flex: 1; padding: 20px 36px; border-radius: 16px; cursor: pointer; border: none; text-decoration: none; text-align: center; }
        .btn-primary { background: var(--primary-color); color: white; } .btn-secondary { background: transparent; border: 2px solid var(--border); }
        .book-description { margin-top: 48px; }
        .search-container { margin-bottom: 40px; } .search-input { width: 100%; padding: 24px 32px; border: 2px solid var(--border); border-radius: 20px; font-size: 20px; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.6); z-index: 1000; opacity: 0; pointer-events: none; transition: opacity 0.5s var(--ease-out-quart); backdrop-filter: blur(12px); } .modal-overlay.active { opacity: 1; pointer-events: all; }
        .menu-modal { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%) translateY(100%); width: 100%; max-width: 428px; background: var(--background); border-radius: 28px 28px 0 0; padding: 40px; transition: transform 0.5s var(--bounce); z-index: 1001; } .menu-modal.active { transform: translateX(-50%) translateY(0); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; } .modal-title { font-size: 32px; font-weight: 800; }
        .close-btn { background: var(--surface); border: none; width: 48px; height: 48px; border-radius: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .menu-sections { display: flex; flex-direction: column; gap: 40px; } .menu-section h3 { font-size: 24px; margin-bottom: 24px; }
        .menu-items { display: flex; flex-direction: column; gap: 12px; } .menu-item { color: var(--text-secondary); text-decoration: none; font-size: 18px; }
        .language-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; } .language-btn { padding: 20px; border: 2px solid var(--border); border-radius: 16px; cursor: pointer; font-size: 18px; }
        .language-btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        .loading { text-align: center; padding: 100px; color: var(--text-secondary); } .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="app-wrapper">
        <!-- ALL YOUR SVG ICONS FROM ORIGINAL FILE -->
        <svg style="display: none;"><defs><symbol id="home-icon" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></symbol><symbol id="search-icon" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></symbol><symbol id="library-icon" viewBox="0 0 24 24"><path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></symbol><symbol id="heart-empty-icon" viewBox="0 0 24 24"><path d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"/></symbol><symbol id="heart-filled-icon" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></symbol><symbol id="download-icon" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></symbol><symbol id="book-icon" viewBox="0 0 24 24"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 2 2h12c1.11 0 2-.9 2-2V4c0-1.1-.89-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></symbol><symbol id="back-arrow-icon" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></symbol></defs></svg>

        <!-- Desktop Layout -->
        <div class="desktop-layout" style="display:none;">
            <div class="sidebar"><div class="sidebar-nav" id="sidebarNav"></div></div>
            <div class="main-content">
                <header><div class="header-content"><button class="back-btn hidden" id="backBtn"><svg class="svg-icon"><use href="#back-arrow-icon"></use></svg></button><h1 class="header-title" id="headerTitle"></h1></div></header>
                <div class="content-area" id="app-container"></div>
            </div>
        </div>

        <!-- Mobile/Tablet Layout -->
        <div class="mobile-layout">
            <header><div class="header-content"><button class="back-btn hidden" id="backBtnMobile"><svg class="svg-icon"><use href="#back-arrow-icon"></use></svg></button><h1 class="header-title" id="headerTitleMobile"></h1></div></header>
            <main id="app-container-mobile"></main>
            <nav><div class="nav-content"><a href="#home" class="nav-item" data-tab="home"><div class="nav-icon"><svg class="svg-icon"><use href="#home-icon"></use></svg></div><span id="navHome"></span></a><a href="#explore" class="nav-item" data-tab="explore"><div class="nav-icon"><svg class="svg-icon"><use href="#search-icon"></use></svg></div><span id="navExplore"></span></a><a href="#library" class="nav-item" data-tab="library"><div class="nav-icon"><svg class="svg-icon"><use href="#library-icon"></use></svg></div><span id="navLibrary"></span></a><a href="#menu" class="nav-item" data-tab="menu"><div class="nav-icon"><svg class="svg-icon"><use href="#menu-icon"></use></svg></div><span id="navMenu"></span></a></div></nav>
        </div>
        
        <!-- Menu Modal -->
        <div class="modal-overlay" id="menuOverlay">
            <div class="menu-modal" id="menuModal">
                <div class="modal-header"><h2 class="modal-title" id="menuTitle">Menu</h2><button class="close-btn" id="closeMenuBtn"><svg class="svg-icon"><use href="#close-icon"></use></svg></button></div>
                <div class="menu-sections" id="menuSectionsContainer"></div>
            </div>
        </div>
    </div>
    
    <!-- STABLE & WORKING JAVASCRIPT -->
    <script>
    // --- EMBEDDED DATA ---
    const booksDB = [ { id: 'whispering_kothi_001', title: 'The Whispering Kothi', author: 'Sandeep Biswal G', tagline: 'A haunting tale that will keep you awake', coverUrl: 'assets/covers/the_whispering_kothi_cover.jpg', sliderImageUrl: 'assets/covers/the_whispering_kothi_slider.jpg', fileUrl: 'assets/books/the_whispering_kothi.pdf', category: 'Horror', isDownloadable: true, isFeaturedInSlider: true, listPrice: '₹99', yourPrice: 'Free', description: 'In the heart of a forgotten town stands a dilapidated mansion, the Kothi, which holds a chilling secret. Locals speak of whispers that echo through its empty halls at night, luring the curious to their doom.' }, { id: 'unknown_camp_002', title: 'An Unknown Camp', author: 'Sandeep Biswal G', tagline: 'Mystery awaits in the wilderness', coverUrl: 'assets/covers/unknown_camp_cover.jpg', sliderImageUrl: 'assets/covers/unknown_camp_slider.jpg', fileUrl: 'assets/books/an_unknown_camp.pdf', category: 'Thriller', isDownloadable: true, isFeaturedInSlider: true, listPrice: '₹109', yourPrice: 'Free', description: 'Deep in the wilderness, a group of hikers stumbles upon an abandoned campsite that shouldn\'t exist on any map. As they investigate, they realize they\'ve walked into something far more sinister.' } ];
    const categoriesDB = [ { name: 'Thriller', iconUrl: 'assets/covers/category_thriller_icon.jpg' }, { name: 'Horror', iconUrl: 'assets/covers/category_horror_icon.jpg' } ];
    const lang_en = { appName: 'Mo Bahi', home: 'Home', explore: 'Explore', library: 'Library', menu: 'Menu', readNow: 'Read Now', categories: 'Categories', newArrivals: 'New Arrivals', read: 'Read', download: 'Download', description: 'Description', listPrice: 'List Price', yourPrice: 'Your Price', searchPlaceholder: 'Search books, authors...', noResults: 'No books found', language: 'Language', myApps: 'My Apps', myOdiaGames: 'My Odia Games', sbCall: 'SB Call', sbSstvEncoder: 'SB SSTV Encoder', followMe: 'Follow Me', pages: 'Pages', about: 'About', privacy: 'Privacy Policy', terms: 'Terms of Service', free: 'Free' };
    const lang_od = { appName: 'ମୋ ବହି', home: 'ହୋମ୍', explore: 'ଅନୁସନ୍ଧାନ', library: 'ଲାଇବ୍ରେରୀ', menu: 'ମେନୁ', readNow: 'ଏବେ ପଢନ୍ତୁ', categories: 'ବର୍ଗ', newArrivals: 'ନୂଆ ଆଗମନ', read: 'ପଢନ୍ତୁ', download: 'ଡାଉନଲୋଡ୍', description: 'ବିବରଣୀ', listPrice: 'ସୂଚୀ ମୂଲ୍ୟ', yourPrice: 'ଆପଣଙ୍କ ମୂଲ୍ୟ', searchPlaceholder: 'ବହି, ଲେଖକ ଖୋଜନ୍ତୁ...', noResults: 'କୌଣସି ବହି ମିଳିଲା ନାହିଁ', language: 'ଭାଷା', myApps: 'ମୋର ଆପ୍ସ', myOdiaGames: 'ମୋ ଓଡିଆ ଗେମ୍ସ', sbCall: 'ଏସବି କଲ୍', sbSstvEncoder: 'ଏସବି SSTV ଏନକୋଡର୍', followMe: 'ମୋତେ ଅନୁସରଣ କରନ୍ତୁ', pages: 'ପୃଷ୍ଠା', about: 'ଆମ ବିଷୟରେ', privacy: 'ଗୋପନୀୟତା ନୀତି', terms: 'ସେବା ସର୍ତ୍ତାବଳୀ', free: 'ମାଗଣା' };
    let lang = { ...lang_en };

    // --- APP STATE ---
    const AppState = { currentRoute: 'home', currentLanguage: 'en', swiper: null, isDesktop: window.innerWidth >= 1024, savedBooks: JSON.parse(localStorage.getItem('savedBooks') || '[]'), searchQuery: '' };

    // --- RENDERER CLASS ---
    class PageRenderer {
        static home() { const featured = booksDB.filter(b => b.isFeaturedInSlider); return `<div class="slider-section fade-in"><div class="swiper"><div class="swiper-wrapper">${featured.map(b => `<div class="swiper-slide slider-slide" style="background-image: url('${b.sliderImageUrl}')"><div class="slider-overlay"></div><div class="slider-content"><div class="slider-title">${b.title}</div><button class="read-now-btn" onclick="BookManager.openReader('${b.id}')">${lang.readNow}</button></div></div>`).join('')}</div></div></div><div class="categories-section slide-in-right"><div class="section-header"><h2 class="section-title">${lang.categories}</h2></div><div class="categories-scroll">${categoriesDB.map(c => `<a href="#category/${c.name}" class="category-item"><div class="category-icon" style="background-image: url('${c.iconUrl}')"></div><div class="category-name">${c.name}</div></a>`).join('')}</div></div><div class="new-arrivals-section"><div class="section-header"><h2 class="section-title">${lang.newArrivals}</h2></div><div class="books-grid">${booksDB.map(b => this.bookCard(b)).join('')}</div></div>`; }
        static bookCard(book) { const isLiked = AppState.savedBooks.includes(book.id); return `<div class="book-card" onclick="window.location.hash='book/${book.id}'"><button class="like-btn ${isLiked ? 'liked' : ''}" onclick="event.stopPropagation(); BookManager.toggleSave('${book.id}')"><svg class="svg-icon"><use href="#${isLiked ? 'heart-filled-icon' : 'heart-empty-icon'}"></use></svg></button><div class="book-cover" style="background-image: url('${book.coverUrl}')"></div><div class="book-info"><h3 class="book-title">${book.title}</h3></div></div>`; }
        static explore() { return `<div class="search-container"><input type="text" class="search-input" id="searchInput" placeholder="${lang.searchPlaceholder}" value="${AppState.searchQuery}"></div><div id="searchResults" class="books-grid">${booksDB.map(b => this.bookCard(b)).join('')}</div>`; }
        static bookDetails(bookId) { const book = booksDB.find(b => b.id === bookId); if (!book) return '<h2>Book not found</h2>'; const isLiked = AppState.savedBooks.includes(book.id); return `<div class="book-details"><div class="book-hero"><div class="book-cover-large" style="background-image: url('${book.coverUrl}')"></div><div><h1 class="book-title-large">${book.title}</h1><p>${book.author}</p><button class="like-btn ${isLiked ? 'liked' : ''}" onclick="BookManager.toggleSave('${book.id}')"><svg class="svg-icon"><use href="#${isLiked ? 'heart-filled-icon' : 'heart-empty-icon'}"></use></svg></button></div></div><div class="book-pricing"><div class="pricing-row"><span>${lang.listPrice}</span><span>${book.listPrice}</span></div><div class="pricing-row"><span>${lang.yourPrice}</span><span>${book.yourPrice === 'Free' ? lang.free : book.yourPrice}</span></div></div><div class="book-actions">${book.isDownloadable ? `<a href="${book.fileUrl}" download class="action-btn btn-secondary">${lang.download}</a>` : ''}<button class="action-btn btn-primary" onclick="BookManager.openReader('${book.id}')">${lang.read}</button></div><div class="book-description"><h3>${lang.description}</h3><p>${book.description}</p></div></div>`; }
        static menu() { return `<div class="menu-section"><h3 id="languageTitle">${lang.language}</h3><div class="language-grid" id="languageGrid"></div></div><div class="menu-section"><h3 id="myAppsTitle">${lang.myApps}</h3><div class="menu-items"><a href="#" class="menu-item" id="myOdiaGamesLink">${lang.myOdiaGames}</a><a href="#" class="menu-item" id="sbCallLink">${lang.sbCall}</a><a href="#" class="menu-item" id="sbSstvLink">${lang.sbSstvEncoder}</a></div></div><div class="menu-section"><h3 id="followMeTitle">${lang.followMe}</h3><div class="menu-items"><a href="https://instagram.com" class="menu-item" target="_blank">Instagram</a></div></div><div class="menu-section"><h3 id="pagesTitle">${lang.pages}</h3><div class="menu-items"><a href="#" class="menu-item" id="aboutLink">${lang.about}</a><a href="#" class="menu-item" id="privacyLink">${lang.privacy}</a><a href="#" class="menu-item" id="termsLink">${lang.terms}</a></div></div>`; }
    }
    
    // --- APP LOGIC CLASSES ---
    class LayoutManager {
        static init() { this.updateLayout(); window.addEventListener('resize', this.updateLayout); }
        static updateLayout() { const isNowDesktop = window.innerWidth >= 1024; if (isNowDesktop === AppState.isDesktop && document.body.dataset.layout) return; AppState.isDesktop = isNowDesktop; document.body.dataset.layout = isNowDesktop ? 'desktop' : 'mobile'; document.querySelector('.desktop-layout').style.display = isNowDesktop ? 'flex' : 'none'; document.querySelector('.mobile-layout').style.display = isNowDesktop ? 'none' : 'block'; if (isNowDesktop) this.setupDesktopNavigation(); Router.handleRoute(true); }
        static getContainer() { return AppState.isDesktop ? document.getElementById('app-container') : document.getElementById('app-container-mobile'); }
        static getBackBtn() { return AppState.isDesktop ? document.getElementById('backBtn') : document.getElementById('backBtnMobile'); }
        static getHeaderTitle() { return AppState.isDesktop ? document.getElementById('headerTitle') : document.getElementById('headerTitleMobile'); }
        static setupDesktopNavigation() { const nav = document.getElementById('sidebarNav'); if (nav) nav.innerHTML = `<a href="#home" class="sidebar-nav-item" data-tab="home"><svg class="svg-icon"><use href="#home-icon"></use></svg><span>${lang.home}</span></a><a href="#explore" class="sidebar-nav-item" data-tab="explore"><svg class="svg-icon"><use href="#search-icon"></use></svg><span>${lang.explore}</span></a><a href="#library" class="sidebar-nav-item" data-tab="library"><svg class="svg-icon"><use href="#library-icon"></use></svg><span>${lang.library}</span></a><a href="#menu" class="sidebar-nav-item" data-tab="menu"><svg class="svg-icon"><use href="#menu-icon"></use></svg><span>${lang.menu}</span></a>`; }
    }
    class LanguageManager {
        static available = { 'en': 'English', 'od': 'ଓଡ଼ିଆ' };
        static init() { const savedLang = localStorage.getItem('selectedLanguage') || 'en'; if (savedLang === 'od') lang = { ...lang_od }; AppState.currentLanguage = savedLang; }
        static switch(code) { if (code === 'en') lang = { ...lang_en }; else if (code === 'od') lang = { ...lang_od }; AppState.currentLanguage = code; localStorage.setItem('selectedLanguage', code); this.updateUI(); Router.handleRoute(true); MenuModal.hide(); }
        static updateUI() { const textContent = {'navHome':'home','navExplore':'explore','navLibrary':'library','navMenu':'menu','menuTitle':'menu'}; Object.entries(textContent).forEach(([id,key]) => { const el = document.getElementById(id); if (el) el.textContent = lang[key]; }); document.getElementById('menuSectionsContainer').innerHTML = PageRenderer.menu(); document.getElementById('languageGrid').innerHTML = Object.entries(this.available).map(([code, name]) => `<button class="language-btn ${code === AppState.currentLanguage ? 'active' : ''}" onclick="LanguageManager.switch('${code}')">${name}</button>`).join(''); if(AppState.isDesktop) LayoutManager.setupDesktopNavigation(); Router.updateNav(AppState.currentRoute); }
    }
    class Router {
        static init() { window.addEventListener('hashchange', () => this.handleRoute()); this.handleRoute(true); }
        static handleRoute(force = false) { const hash = window.location.hash.slice(1) || 'home'; const [route, ...params] = hash.split('/'); if (!force && route === AppState.currentRoute) return; AppState.currentRoute = route; if (route === 'menu') { MenuModal.show(); } else { this.render(route, params); } }
        static render(route, params) { this.updateHeader(route, params); this.updateNav(route); const container = LayoutManager.getContainer(); container.innerHTML = '<div class="loading">Loading...</div>'; setTimeout(() => { let content = ''; if (route === 'home') content = PageRenderer.home(); else if (route === 'explore') content = PageRenderer.explore(); else if (route === 'book') content = PageRenderer.bookDetails(params[0]); else content = `<h2>${route} Page</h2>`; container.innerHTML = `<div class="page-transition active">${content}</div>`; if(route === 'home' && typeof Swiper !== 'undefined') { if (AppState.swiper) AppState.swiper.destroy(); AppState.swiper = new Swiper('.swiper', { loop: true, autoplay: { delay: 5000 } }); } else if (route === 'explore') { document.getElementById('searchInput').addEventListener('input', this.performSearch); this.performSearch(); } }, 50); }
        static performSearch() { const query = document.getElementById('searchInput').value.toLowerCase(); AppState.searchQuery = query; const results = booksDB.filter(b => b.title.toLowerCase().includes(query) || b.author.toLowerCase().includes(query)); const container = document.getElementById('searchResults'); if (results.length > 0) { container.innerHTML = results.map(b => PageRenderer.bookCard(b)).join(''); } else { container.innerHTML = `<p>${lang.noResults}</p>`; } }
        static updateHeader(route, params) { const titleEl = LayoutManager.getHeaderTitle(); const backBtn = LayoutManager.getBackBtn(); if(route === 'home') { titleEl.textContent = lang.appName; backBtn.classList.add('hidden'); } else { let title = lang[route] || route.charAt(0).toUpperCase() + route.slice(1); if(route === 'book') { const book = booksDB.find(b=>b.id===params[0]); if(book) title = book.title; } titleEl.textContent = title; backBtn.classList.remove('hidden'); } }
        static updateNav(route) { document.querySelectorAll('.nav-item, .sidebar-nav-item').forEach(i => i.classList.toggle('active', i.dataset.tab === route)); }
    }
    class BookManager {
        static openReader(bookId) { const book = booksDB.find(b => b.id === bookId); if (!book) return; window.open(`reader.html?file=${encodeURIComponent(book.fileUrl)}&title=${encodeURIComponent(book.title)}`, '_blank'); }
        static toggleSave(bookId) { const index = AppState.savedBooks.indexOf(bookId); if (index > -1) AppState.savedBooks.splice(index, 1); else AppState.savedBooks.push(bookId); localStorage.setItem('savedBooks', JSON.stringify(AppState.savedBooks)); Router.handleRoute(true); }
    }
    class MenuModal { static init() { document.getElementById('closeMenuBtn').addEventListener('click', this.hide); document.getElementById('menuOverlay').addEventListener('click', (e) => { if(e.target.id==='menuOverlay') this.hide(); }); } static show() { document.getElementById('menuOverlay').classList.add('active'); document.getElementById('menuModal').classList.add('active'); } static hide() { document.getElementById('menuOverlay').classList.remove('active'); document.getElementById('menuModal').classList.remove('active'); } }

    // --- APP INITIALIZATION ---
    document.addEventListener('DOMContentLoaded', () => {
        LanguageManager.init();
        LayoutManager.init();
        MenuModal.init();
        LanguageManager.updateUI();
        Router.init();
        document.querySelectorAll('.back-btn').forEach(btn => btn.addEventListener('click', () => history.back()));
    });
    </script>
</body>
</html>
